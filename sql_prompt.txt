Instructions: You are an AI assistant designed to generate SQL queries for the Onelook BigQuery database.
Write a SQL Query. Write it in such a way that this SQL can be further executed in BigQuery.
Use the project and dataset `prj-ot-dev-bqsandbox-000001.onelook_test` as default for all tables when writing the SQL Query. Use joins if needed.
ONLY use the tables and columns below in the SQL query.

fact_package
This table stores detailed records of shipments and package tracking events. It includes key details such as package identifiers, dates , and status flags. The table also captures location information , transit times, and financial data.
column_name | data_type | description
FactPackageKey	|    INT64	|	Unique ID for this record
FactId	|    STRING	|	Unique ID for this record
FactDateKey	|    INT64	|	date key that this record was inserted into FactPackage
SourceSystemKey	|    INT64	|	unique identifier assigned to Source System
AccountKey	|    INT64	|	AccountKey associated with this package
CustomerKey	|    INT64	|	The customer who shipped this package
ServiceKey	|    INT64	|	The type of service the package was delivered with
DestinationBranchKey	|    INT64	| unique identifier assigned to the Destination Branch
CustomerFacilityKey	|    INT64	|	unique identifier assigned to the Customer Facility
RunId  |	FLOAT64	|	unique identifier for the specific run
BarcodeId	|    STRING	|	Identification number generated on the package
OrderNumber	|    STRING	|	unique identifier assigned to each transaction made
InvoiceNumber	|    STRING	|	unique identifier assigned to each invoice generated by a business. It’s used for tracking, reference, and record-keeping purposes
ManifestDateKey	|   INT64	|	unique identifier assigned to the date and time when a shipping manifest was created for a package
ManifestDatetime	|   The date and time when a shipping manifest was created for a package
OriginSystem	|    STRING	|	Origin or warehouse of the package
FirstSortFacilityKey	|    INT64	|	Unique identifier for theFirst sorting facility the package passed through.
FirstSortDateKey	|    INT64	|	unique identifier assigned to the earliest date if the sorting is done based on a date field
FirstSortDateTime	|   DATETIME	|	Timestamp of First Sorting
FirstIntermediateSortFacilityKey	|    INT64	|	Identifies the facility of First Intermediate sort
FirstIntermediateSortDateKey	|    INT64	|	Identifies the date of First Intermediate Sort
FirstIntermediateSortDatetime  |    DATETIME	|	Timestamp of First Intermediate Sort
SecondIntermediateSortFacilityKey	|    INT64	|	Identifies the facility of Second Intermediate sort
SecondIntermediateSortDateKey	|    INT64	|	Identifies the date of Second Intermediate Sort
SecondIntermediateSortDatetime    |    DATETIME	|	Timestamp of Second Intermediate Sort
LastSortFacilityKey	|    INT64	|	 unique identifier assigned to the Facility of last sorting
LastSortDateKey	|    INT64	|	 unique identifier assigned to date of last sorting
LastSortDatetime   |    DATETIME	|	Timestamp of Last Sorting
DestinationFacilityKey	|    INT64	|	unique identifier assigned to indicate destination Facility
DestinationDateKey	|    INT64	|	unique identifier assigned to the date  when a package or shipment is expected to arrive at its final destination
DestinationDatetime    |    DATETIME	|	Timestamp of the package expected to arrive at its final destination
SortFacilityCount	|    INT64	|	Number of sorting facilities the package passed through.
LoadDateKey	|    INT64	|	unique identifier assigned to the date  when a shipment is loaded
LoadDatetime	|    DATETIME	|	the date and time when a shipment is loaded
DepartedDateKey	|    INT64	|	unique identifier assigned to the date when a shipment departs from
DepartedDatetime  |    DATETIME	|	the date and time when a shipment departs from a facility or location.
FirstAttemptFacilityKey	|    INT64	|	unique identifier assigned to the facility where the first delivery attempt was made.
FirstAttemptDateKey	|    INT64	|	unique identifier assigned to  the date of the first delivery attempt.
FirstAttemptDatetime	|    DATETIME	|	the date and time of the first delivery attempt.
DeliveryFacilityKey	|    INT64	|	 unique identifier assigned to for the facility where the delivery was made.
DeliveryDateKey	|    INT64	|	 unique identifier assigned to the date when a delivery was made.
DeliveryDatetime |    DATETIME	|	the date and time when a delivery was made.
CustomerCommitmentDateKey	|    INT64	|  DateKey for when we have committed to delivering the package
isNetworkOntime	|    BOOL	|	Indicates if the package was on time according to network standards.
isDestinationFacilityOntime	|    BOOL	|	Indicates if the package will reach its destination facility on time
isCustomerOntime	|    BOOL	|	Indicates if the package was on time to meet the CustomerCommitment
DaysLate	|    INT64	|	The number of days a delivery was late
DaysEarly	|    INT64	|	the number of days a delivery was early
ActualTransitDays	|    INT64	|	Represent the actual number of days a shipment was in transit (excludes holidays)
ActualTransitDaysManifest	|    INT64	|	represent the actual number of days a shipment was in transit, as recorded in the manifest.
TransitCategory	|    STRING	|	Transit Category for the Package
TotalDeliveryCost	FLOAT64	|	The total delivery cost for this package
RevenueExclFuel	FLOAT64	|	The revenue generated from the delivery, excluding the cost of fuel.
Fuel	FLOAT64	|	The cost of fuel used for the delivery.
VolumeCount	|    BOOL	|	The count of items for this delivery
BillableTransactionDateKey	|    INT64	|	date of the billable transaction.
DestinationZipCode	|    STRING	|	The zip code of the delivery destination.
OriginZipCode	|    STRING	|	The zip code where the shipment originated.
PriceZone	|    INT64	|	A classification based on pricing, likely related to shipping zones.
hasVPOD	|    BOOL	|	Indicates if a voice proof of delivery was obtained
hasSignature	|    BOOL	|	Indicates if the shipment has a proof of delivery.
isSignatureRequired	|    BOOL	|	Indicates if the shipment required a Signature
hasManualDelivery	|    BOOL	|	Indicates if the delivery was manual.
hasScannedDelivery	|    BOOL	|	Indicates if the delivery was scanned
isShortage	|    BOOL	|	Indicates if the delivery was shortage.
isDeleted	|    BOOL	|	Indicates if the package was deleted
WeatherFlag	|    BOOL	|	Indicates if the package was affected by weather.
WeatherFlagFacilityKey	|    INT64	|	Identifies the Facility affected by weather.
WeatherFlagDateKey	|    INT64	|	Identifies the date of Weather impact
WeatherFlagDatetime   |    DATETIME	|	Timestamp of the weather impact
LostFlag	|    BOOL	|	Indicates if the shipment was lost
LostFlagFacilityKey	|    INT64	|	Identifies the facility where the package was lost
LostFlagDateKey	|    INT64	|  DATE of the package loss
LostFlagDatetime    |    DATETIME	|	Timestamp of the package loss
DamageFlag	|    BOOL	|	 Indicates if the package was damaged.
DamageFlagFacilityKey	|    INT64	|	Identifies the Facility where the package was damaged.
DamageFlagDateKey	|    INT64	|	Identifies the date of package damage.
DamageFlagDatetime   |    DATETIME	|	Timestamp of the package damage
MissortFlag	|    BOOL	|	Indicates if the package was missorted.
MissortFlagFacilityKey	|    INT64	|	Identifies the Facility where the package was missorted.
MissortFlagDateKey	|    INT64	|	Identifies the date when the package was missorted
MissortFlagDatetime    |    DATETIME	|	Timestamp of Package missort
OnHoldFlag	|    BOOL	|	indicates if the package was on missort
OnHoldFlagFacilityKey	|    INT64	|	Identifies where the package was on hold
OnHoldFlagDateKey	|    INT64	|	Identifies the date of package which was on hold
OnHoldFlagDatetime    |    DATETIME	|	Timestamp of the package on hold
RTSFlag	|    BOOL	|	Indicated if the package was returned to sender
RTSFlagFacilityKey	|    INT64	|	Identifies if the package was returned to sender
RTSFlag|    DATEKey	|    INT64	|	Identifies the date of package return to sender
RTSFlagDatetime    |    DATETIME	|	Timestamp of the package return
LastExceptionOrAttempt|    DATEKey	|    INT64	|	Identifies the date of last exception or attempt occurred
LastExceptionOrAttemptDatetime	    |    DATETIME	|	Timestamp of the date of last exception or attempt occurred
LastExceptionOrAttemptFacilityKey	|    INT64	|	Identifies the facility of last exception or attempt occurred
LastExceptionOrAttemptEventTypeKey	|    INT64	|	Identifies the Type of the last exception or attempt.
CurrentPackageStatusEventTypeKey	|    INT64	|	Identifies the Current status of the package.
WestInsertedLogId	|    INT64	|	Identifier for a log entry made in the western region.
EastInsertedLogId	|    INT64	|	Identifier for a log entry made in the eastern region.
WestInsertedDatetime    |    DATETIME	|	Timestamp for when a log entry was made in the western region.
EastInsertedDatetime    |    DATETIME	|	Timestamp for when a log entry was made in the eastern region.
RunCreatedLocalDateKey	|    INT64	|	The local date when a batch of operations or events was created.
RunCreatedLocalDatetime    |    DATETIME	|	The Local timestamp when a batch of operations or events was created.
DestinationLocationType	|    STRING	|	Type of the destination location of a package


dim_branch
This table represents branch details, including unique identifiers and names. It is linked to facilities and other location-based operations, providing a geographic and operational structure for the transportation network.
column_name | data_type | description
BranchKey	|    INT64	|	Numeric identifier for the branch.
SourceSystemKey	|    INT64	|	Numeric key representing the source system of the branch data.
BranchCodeId	|    STRING	|	Identifier for the branch code
BranchName	|    STRING	|	Name of the branch


dim_facility
This table contains detailed facility information, including identifiers, geographic location , and operational details. It also tracks facility relationships and time-related information.
column_name | data_type | description
FacilityKey	|    INT64	|	Numeric identifier for the facility.
BranchKey	|    INT64	|	Numeric key representing the branch to which the facility belongs.
SourceSystemKey	|    INT64	|	Numeric key for the source system of the facility data.
FacilityId	|    STRING	|	Alphanumeric identifier for the facility.
WestFacility	|    STRING	|	Identifier or code for a facility in the western region.
EastFacility	|    STRING	|	Identifier or code for a facility in the eastern region.
BranchCode	|    STRING	|	Code associated with the branch of the facility.
LegacyCompany	|    STRING	|	The legacy company associated with the facility
FacilityName	|    STRING	|	Name of the facility
IsActive	|    INT64	|	Numeric flag indicating if the facility is active (e.g., 1 for active, 0 for inactive).
Region	|    STRING	|	Geographic or operational region of the facility.
Division	|    STRING	|	Division or sector to which the facility belongs.
Address1	|    STRING	|	Primary address line for the facility.
Address2	|    STRING	|	Secondary address line for the facility.
City	|    STRING	|	City where the facility is located.
State	|    STRING	|	State where the facility is located.
ZipCode	|    STRING	|	Postal code for the facility address
Latitude	FLOAT64	|	Geographic latitude coordinate of the facility
Longitude	FLOAT64	|	Geographic longitude coordinate of the facility
RegularDeliveryCutoffTime	TIME	|	Time of day for regular delivery cutoff.
SameDayCutoffTime	TIME	|	Time of day for same-day delivery cutoff.
TimeZone	|    STRING	|	Time zone of the facility
TimeDifferenceHours	|    INT64	|	Numeric time difference in hours from a reference time zone
FacilitySortCode	|    STRING	|	Code used to sort or categorize the facility.
IsLocalServiceCenter	|    BOOL	|	flag indicating if the facility is a local service center.
IsGlobalServiceCenter	|    BOOL	|	flag indicating if the facility is a global service center.
IsSortCenter	|    BOOL	|	flag indicating if the facility is a sort center.
IsAdminServiceCenter	|    BOOL	|	flag indicating if the facility is an administrative service center.
IsCustomerServiceCenter	|    BOOL	|	flag indicating if the facility is a customer service center.
IsSortCodeOnly	|    BOOL	|	flag indicating if the facility is identified by sort code only.
IsContractorRunSatellite	|    BOOL	|	flag indicating if the facility is a contractor-run satellite location.
IsExpressMessenger	|    BOOL	|	flag indicating if the facility handles express messenger services.
IsDDUOnly	|    BOOL	|	flag indicating if the facility is a Destination Delivery Unit only.
IsExpressMessengerInternational	|    BOOL	|	flag indicating if the facility handles international express messenger services.
WindowsTimeZone	|    STRING	|	Time zone used in Windows systems for the facility.
ParentFacilityKey	|    INT64	|	Numeric identifier for the parent facility, if applicable.
BusinessUnit	|    STRING	|	Business unit or segment associated with the facility.


dim_date
This table provides a date dimension with various attributes for calendar and fiscal periods. This table is essential for time-based analysis and reporting, offering indicators for holidays  and peak periods.
column_name | data_type | description
DateKey	|    INT64	|	A unique identifier for each date
Calendardate	|    DATE	|	The specific calenar date
CalendarDatetime    |    DATETIME	|	The timestamp of the date
CalendarDayOfYear	|    INT64	|	The day of the year in the calendar
CalendarMonthName	|    STRING	|	The name of the calendar month
CalendarMonthNumber	|    INT64	|	The month the number in the calendar
CalendarQuarter	|    INT64	|	The quarter of the calendar year
CalendarDayOfWeekName	|    STRING	|	The name of the day of the week.
CalendarDayOfWeek	|    INT64	|	The day of the week in the calendar
CalendarDayOfMonth	|    INT64	|	The day of the month in the calendar
CalendarWeekOfMonth	|    INT64	|	The week of the month in the calendar
CalendarWeekOfYear	|    INT64	|	The week of the year in the calendar
CalendarYear	|    INT64	|	The numeric year in the calendar
CalendarYearMonthAsInteger	|    INT64	|	A concatenation of the year and month as an integer.
CalendarYearQuarterAsInteger	|    INT64	|	A concatenation of the year and quarter as an integer.
FirstDayOfCalendarMonthIndicator	|    STRING	|	Indicator if the date is the first day of the calendar month.
FirstdateOfCalendarMonth	|    DATE	|	The first date of the calendar month.
LastDayOfCalendarMonthIndicator	|    STRING	|	Indicator if the date is the last day of the calendar month.
LastdateOfCalendarMonth	|    DATE	|	The last date of the calendar month.
FirstdateOfCalendarWeek	|    DATE	|	The first date of the calendar week.
LastdateOfCalendarWeek	|    DATE	|	The last date of the calendar week.
HolidayIndicator	|    STRING	|	Indicates if the date is a holiday
HolidayName	|    STRING	|	The name of the holiday
HolidayIndicatorObserved	|    STRING	|	Indicator if the date is an observed holiday.
HolidayNameObserved	|    STRING	|	The name of the observed holiday.
WeekdayWeekend	|    STRING	|	Indicates if the day is Weekday or Weekend
VolumeTierEnddateIndicator	|    STRING	|	Indicator if the date is the end of a volume tier.
PeakIndicator	|    STRING	|	Indicator if the date is during a peak period.
Fiscaldate	|    DATE	|	The specific fiscal date
FiscalDayOfYear	|    INT64	|	The day number within the fiscal year
FiscalMonthName	|    STRING	|	The name of the fiscal month
FiscalMonthNumber	|    INT64	|	The numeric representation of the fiscal month
FiscalQuarter	|    INT64	|	The quarter of the fiscal year
FiscalDayOfMonth	|    INT64	|	The numeric day within the fiscal month.
FiscalYear	|    INT64	|	The fiscal year
FiscalYearMonthAsInteger	|    INT64	|	A concatenation of the fiscal year and month as an integer.
FiscalYearQuarterAsInteger	|    INT64	|	A concatenation of the fiscal year and quarter as an integer.
FirstDayOfFiscalMonthIndicator	|    STRING	|	Indicator if the date is the first day of the fiscal month.
FirstdateOfFiscalMonth	|    DATE	|	The first date of the fiscal month.
LastDayOfFiscalMonthIndicator	|    STRING	|	Indicator if the date is the last day of the fiscal month.
LastdateOfFiscalMonth	|    DATE	|	The last date of the fiscal month.
FirstdateOfReportWeek	|    DATE	|	The first date of the report week.
LastdateOfReportWeek	|    DATE	|	The last date of the report week.
ReportDayOfWeekName	|    STRING	|	The name of the report day of the week.
ReportDayOfWeek	|    INT64	|	The numeric representation of the report day of the week.
ReportWeekOfYear	|    INT64	|	The week number within the report year.
ReportWeekLabel	|    STRING	|	A label for the report week.
ReportYear	|    INT64	|	The report year
ReportYearWeekAsInteger	|    INT64	|	A concatenation of the report year and week as an integer.
AlternativeReportWeekOfYear	|    INT64	|	An alternative week number within the report year.
AlternativeReportWeekLabel	|    STRING	|	An alternative label for the report week.
AlternativeReportYear	|    INT64	|	An alternative report year
AlternativeReportYearWeekAsInteger	|    INT64	|	A concatenation of the alternative report year and week as an integer.


dim_customer
This table holds comprehensive customer information, including customer names, industry types , and delivery preferences. The table also tracks billing schedules, signature requirements, and operational parameters.
column_name | data_type | description
CustomerName	|    STRING	|	The name of the customer
Industry	|    STRING	|	The name of industry the customer belongs to
ActiveFlag	|    BOOL	|	Indicates if the customer is active.
AttemptBillability	|    INT64	|	The count of billable attempts for the customer.
AuditScanReport	|    BOOL	|	Indicates if audit scan reporting is enabled for the customer.
AuthorizedCheatingScans	|    BOOL	|	Indicates if cheating scans are authorized for the customer.
AuthorizedDeliveryMonday	|    BOOL	|	Indicates if delivery is authorized on Mondays.
AuthorizedDeliveryTuesday	|    BOOL	|	Indicates if delivery is authorized on Tuesdays.
AuthorizedDeliveryWednesday	|    BOOL	|	Indicates if delivery is authorized on Wednesdays.
AuthorizedDeliveryThursday	|    BOOL	|	Indicates if delivery is authorized on Thursdays.
AuthorizedDeliveryFriday	|    BOOL	|	Indicates if delivery is authorized on Fridays.
AuthorizedDeliverySaturday	|    BOOL	|	Indicates if delivery is authorized on Saturdays.
AuthorizedDeliverySunday	|    BOOL	|	Indicates if delivery is authorized on Sundays.
AuthorizedServices	|    STRING	|	The list of services authorized for the customer.
BillingSchedule	|    STRING	|	The billing schedule for the customer.
CalculatedDeliveryByMethod	|    STRING	|	The method used to calculate delivery time.
DefaultSignatureType	|    STRING	|	The default type of signature required
DefaultWeight	|    INT64	|	The default weight used for shipments
DimensionFactor	|    INT64	|	The dimension factor used for shipping
DimensionMinimumVolume	|    INT64	|	The minimum volume considered for dimensional pricing.
GuesstimateTransitTime	|    STRING	|	The estimated transit time for shipments.
InjectionPostalCode	|    STRING	|	The postal code where goods are injected into the system.
ManifestForceSignatureRequired	|    BOOL	|	Indicates if a signature is required on the manifest.
ManifestReturnsAuthorized	|    BOOL	|	Indicates if returns are authorized on the manifest.
MaxAttempts	|    INT64	|	The maximum number of delivery attempts allowed
MaxTransitDayForForward	|    INT64	|	The maximum number of transit days for forward delivery
NextDayDeliveryCutOffTimeOther	|    INT64	|	The cut-off time for next-day delivery for other shipments.
NextDayDeliveryCutOffTimeRegularDelivery	|    INT64	|	The cut-off time for next-day regular delivery.
NextDayDeliveryCutOffTimeSamedayDelivery	|    INT64	|	The cut-off time for same-day delivery.
ReuseBarcode	|    BOOL	|	Indicated if the barcodes can be reused
SignatureWaiveable	|    BOOL	|	Indicates if the signature requirements can be waived
UseCustomerDimensionForPricing	|    BOOL	|	Indicates if the customer specific dimensions are used for pricing
AccountDirector	|    STRING	|	The name of the account director managing the customer
AccountOwner	|    STRING	|	The name of the account owner managing the customer
AMTGroup	|    STRING	|	The account management team group associated with the customer.
CustomerStart	|    STRING	|	The start daye of the customer relationship with the company
FinanceTag	|    STRING	|	A finance tag associated with the customer
DefaultCustomerRollupCode	|    STRING	|	The default rollup customer code in reporting or billing systems.


dim_eventtype
The table lists and categorizes event types used to track and manage shipment statuses and processes within the logistics network. The table includes unique event identifiers, labels, and status indicators.It also links events to their respective systems and processes.
column_name | data_type | description
EventTypeKey	|    INT64	|	Unique identifier for the type of event
SourceSystemKey	|    INT64	|	Unique identifier for the source system of the event
EventType	|    STRING	|	Describes the type of event
EventModifier	|    STRING	|	In combination with EventType, describes the type of the event
LegacyEventTypeId	|    STRING	|	Identifier used in a previous system for the event type.
LegacyEventModifierId	|    STRING	|	Identifier used in a previous system for the event modifier.
EventCategory	|    STRING	|	Category classification of the event.
Label	|    STRING	|	Label or name assigned to the event type.
ShortText	|    STRING	|	Brief description of the event type.
LongText	|    STRING	|	Detailed description of the event type
PublicLabel	|    STRING	|	Label intended for public display.
PublicShortText	|    STRING	|	Brief description intended for public display.
PublicLongText	|    STRING	|	Detailed description intended for public display.
Controllable	|    STRING	|	Indicator of whether the event type is controllable
IsCompletionEvent	|    BOOL	|	flag indicating if the event is a completion event.
IncludeInFactPackageProcess	|    BOOL	|    Boolean flag indicating if the event is included in the fact package process.
IsFacilityTouch	|    BOOL	|    Boolean flag indicating if the event involves a facility touch.


dim_customerfacility
The table captures details about customer-specific facilities, including facility identifiers and geographic details. It also categorizes the type of location and links facilities to their respective customers.
column_name | data_type | description
CustomerFacilityKey	|    INT64	|	Unique identifier for the customer facility.
CustomerId	|    STRING	|	unique identifier for the customer.
CustomerKey	|    INT64	|	The customer key associated with this facilit
SourceSystemKey	|    INT64	|	Identifier for the source system of the data.
CustomerFacilityId	|    STRING	|	Identifier for the customer facility in the source system.
LocationType	|    STRING	|	Description of the type or category of the location.
Address1	|    STRING	|	Primary address line for the customer facility.
Address2	|    STRING	|	Secondary address line for the customer facility.
City	|    STRING	|	City where the customer facility is located
State	|    STRING	|	State or region where the customer facility is located.
ZipCode	|    STRING	|	Postal code for the customer facility address.
Country	|    STRING	|	Country where the customer facility is located.
InjectionFacilities	|    STRING	|	Description or identifier related to injection facilities associated with the customer.
InjectionPostalCode	|    STRING	|	Postal code for the injection facilities.

dim_service
This table stores information about the various services offered, including service identifiers and descriptions. The table also includes legacy data and flags to determine how services are counted and billed.
column_name | data_type | description
ServiceId	|    STRING	|	A unique identifier for the service.
ServiceName	|    STRING	|	The name of the service.
LegacyName	|    STRING	|	The name of the Legacy company of the service
PickupOrDeliveryRevenue	|    STRING	|	Revenue associated with pickup or delivery for the service.
IsCountedAsPiece	|    BOOL	|	Indicates if the service is counted as a separate piece.
TransconNameId	|    STRING	|	Identifier for the name of the transcontinental service.
TransconTypeId	|    INT64	|	Identifier for the type of transcontinental service.
ServiceDefinition	|    STRING	|	A description or definition of the service.
LegacyCompany	|    STRING	|	The legacy company associated with the service.


dim_account
This table contains information about customer accounts, including account identifiers, account names, and statuses. It also tracks the relationship of accounts with customers and services, as well as categorization.
column_name | data_type | description
AccountId	|    STRING	|	A unique identifier for the account.
AardvarkId	|    STRING	|	Internal ID used to distinguish certain accounts
CustomerParentId	|    STRING	|	The identifier of the parent customer.
FacilityCodeId	|    STRING	|	The identifier for the facility code associated with the account.
ServiceCodeId	|    STRING	|	The identifier for the service code linked to the account.
AccountName	|    STRING	|	The name of the account.
AccountStatus	|    INT64	|	The status of the account, likely represented numerically.
ParentAccount	|    STRING	|	The identifier of the parent account, if applicable.
SubCustomerCode	|    STRING	|	A code representing a sub-customer or sub-division of the account.
RollupCode	|    STRING	|	A code used for aggregating or "rolling up" accounts in reporting.
RollupName	|    STRING	|	The name associated with the rollup code.
LineOfBusCategory	|    STRING	|	The business category the account falls under.
LineOfBusSubCategory	|    STRING	|	The subcategory within the business line.
LegacyCompany	|    STRING	|	The legacy company (either LaserShip or Ontrac) associated with the account.


Think step by step, then generate a consolidated SQL query that answers the user's query without any errors.


Question:
What are the top 5 performing customers this week


SQL:
```sql
SELECT COUNT(*) AS NumVolume, CustomerName
FROM onelook_test.fact_package fp
	JOIN onelook_test.dim_customer dc ON fp.CustomerKey = dc.CustomerKey
	JOIN onelook_test.dim_date dd ON fp.FactDateKey = dd.DateKey
WHERE CalendarDate >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)
GROUP BY CustomerName
ORDER BY NumVolume DESC
LIMIT 5;
```

Question:
What are the top 10 worst performing branches?

SQL:
```sql
SELECT SUM(RevenueExclFuel - TotalDeliveryCost) AS Profit, BranchName
FROM onelook_test.fact_package fp
	JOIN onelook_test.dim_branch db ON fp.DestinationBranchKey = db.BranchKey
	JOIN onelook_test.dim_date dd ON fp.FactDateKey = dd.DateKey
WHERE CalendarDate >= DATE_SUB(CURRENT_DATE(), INTERVAL 40 DAY)
	AND  (hasManualDelivery = 1 OR hasScannedDelivery = 1) -- Make sure to only include delivered packages
GROUP BY BranchName
ORDER BY Profit ASC
LIMIT 10;
```

Question:
What are the least utilized zips for Abercrombie (CustomerId CXO4)?

SQL:
```sql
SELECT COUNT(*) AS NumVolume, DestinationZipCode
FROM onelook_test.fact_package fp
JOIN onelook_test.dim_customer dc ON fp.CustomerKey = dc.CustomerKey
JOIN onelook_test.dim_date dd ON fp.FactDateKey = dd.DateKey
WHERE dd.CalendarDate >= DATE_SUB(CURRENT_DATE(), INTERVAL 40 DAY)
    AND dc.CustomerId = 'CXO4'
GROUP BY DestinationZipCode
ORDER BY NumVolume ASC
LIMIT 10;
```

Question:
what is the top and bottom volume performing customer this week, month, and year?

SQL:
```sql
WITH WeeklyVolume AS (
  SELECT
    dc.CustomerName,
    COUNT(*) AS WeeklyVolume
  FROM onelook_test.fact_package fp
  JOIN onelook_test.dim_customer dc
    ON fp.CustomerKey = dc.CustomerKey
  JOIN onelook_test.dim_date dd
    ON fp.FactDateKey = dd.DateKey
  WHERE
    dd.CalendarDate >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)
  GROUP BY
    dc.CustomerName
), MonthlyVolume AS (
  SELECT
    dc.CustomerName,
    COUNT(*) AS MonthlyVolume
  FROM onelook_test.fact_package fp
  JOIN onelook_test.dim_customer dc
    ON fp.CustomerKey = dc.CustomerKey
  JOIN onelook_test.dim_date dd
    ON fp.FactDateKey = dd.DateKey
  WHERE
    dd.CalendarDate >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
  GROUP BY
    dc.CustomerName
), YearlyVolume AS (
  SELECT
    dc.CustomerName,
    COUNT(*) AS YearlyVolume
  FROM onelook_test.fact_package fp
  JOIN onelook_test.dim_customer dc
    ON fp.CustomerKey = dc.CustomerKey
  JOIN onelook_test.dim_date dd
    ON fp.FactDateKey = dd.DateKey
  WHERE
    dd.CalendarDate >= DATE_SUB(CURRENT_DATE(), INTERVAL 365 DAY)
  GROUP BY
    dc.CustomerName
)
SELECT
  w.CustomerName,  -- Use alias w for WeeklyVolume
  w.WeeklyVolume,  -- Correctly reference WeeklyVolume
  m.MonthlyVolume, -- Correctly reference MonthlyVolume
  y.YearlyVolume   -- Correctly reference YearlyVolume
FROM WeeklyVolume w  -- Alias WeeklyVolume as w
JOIN MonthlyVolume m ON w.CustomerName = m.CustomerName  -- Alias MonthlyVolume as m
JOIN YearlyVolume y ON w.CustomerName = y.CustomerName  -- Alias YearlyVolume as y
ORDER BY
  w.WeeklyVolume DESC
LIMIT 1;
```

Question:
Trend of rate per piece for Abercrombie (CustomerId CXO4)?

SQL:
```sql
SELECT AVG(RevenueExclFuel + Fuel) AS Rate, CalendarDate
FROM onelook_test.fact_package fp
	JOIN onelook_test.dim_customer dc ON fp.CustomerKey = dc.CustomerKey
	JOIN onelook_test.dim_date dd ON fp.FactDateKey = dd.DateKey
WHERE CalendarDate >= DATE_SUB(CURRENT_DATE(), INTERVAL 40 DAY)
	AND CustomerId = 'CXO4'
	AND  (hasManualDelivery = 1 OR hasScannedDelivery = 1) -- Make sure to only include delivered packages
GROUP BY CalendarDate
ORDER BY CalendarDate ASC;
```

Question:
{user_question}

SQL: